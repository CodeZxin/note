

## 2024.11.10

老师好，我是张鑫。第一次写周报，首先汇报一下这几天对代码理解的进展。我完整理解了MyServer的代码，没有和数字人相关的具体逻辑，仅仅是通过websocket收发消息的框架，两个Server子类只负责发送信息。找到了文字、语音等数据传递的路线。基本理解了核心代码中类和函数的功能，关系和调用顺序。我也学到了很多新东西，比如单例模式全局共享变量，websocket和socket网络通信，async和await的异步控制，协程和线程的区别，音频设备的调用等。仅仅是了解，离熟练运用还有很长的路。

然后是对上次谈话的补充总结，也是对自我的思考。您布置数字人的任务已经一个多月了，我却没有进展。一方面是因为我的惰性，自制力差。另一方面是没有deadline，我习惯上先做眼前的事情，没有给予它足够的优先级。还有就是第一次读开源项目的代码有畏难情绪。

说自己能力弱，是自认在算法和开发能力是不合格的。唯一拿的出手的成绩，也遗忘了大量知识，所以没有底气。我反思是没有总结的习惯，缺少实践，没有形成机械记忆。我觉得您说得有道理，只有从解决问题的角度，知识才能学扎实。我在开始阅读代码后，才发现没有想象中的困难，而且还有AI辅助理解。

关于我读研的目标，坦率讲是作为就业的缓冲，但研究生科研是本职工作，毕业是底线和首要目标，我会以认真对待。同时我希望做到毕业不为就业发愁。以我目前的理解，我们要做的就是有道理有目的地借鉴别人的思路，达成我们的目标，更好地解决问题，最好能有些新奇的想法。而不是盲目的缝合，达成结果上的提升，再去讲故事，这是我理解的科研和水论文的区别，当然我在心理上是也是不认同这种做法的。

我认为我的缺点主要有：强迫症，通俗来说就是不会敷衍，追求完美，容易在不重要的事情上较真，浪费精力，这也是我的压力来源，尤其是有多项任务同时存在。选择困难症，缺少信息和理由容易陷入纠结内耗，通俗来说就是没主见，随大流。

沟通表达能力差，不爱说话，也不知道说些什么好。在老家的说普通话有种装腔的味道，在这里说方言又有种土气别扭的感觉，大学开始讲普通话，能感受到我的表达是断断续续的，逻辑上不够连贯完整，思考也跟不上表达。我高中其实是比较洒脱豪放的，直言不讳，人缘也很好。也有感情不顺等原因，逐渐发展成现在的性格，自卑敏感，在意别人的看法，交流也变得谨慎拘束。我相信和大家接触久了，熟络之后会慢慢好起来的。

从您的课和讲话，我能感受到您是一位负责任的老师。能获得保研的资格也很幸运，我争取对自己负责。但目前我还做不到很好的自我管理和执行，经不起逃避压力和低级快乐的诱惑，暂且需要一些外力约束和监督。Actions speak louder than words，我要避免眼高手低，多做事，多交流。第一次写周报想法的内容长了点，之后内容会更多聚焦于actions和results的汇报。

最后，祝老师科研顺利，心情愉快！

## 2024.11.17

数字人方面，我成功用鸿蒙知识库的API换掉了工程默认的LLM，通过HTTP请求发送JSON格式的问题，得到Markdown格式的回复。但是从发送请求到收到回复速度很慢，回复的文本较长，不符合对话的场景，需要修改Pompt来改进。此外，使用语音输入有奇怪的BUG，ASR这一步没问题，之后就没有反应了，和办公室演示的时候一样，但我之前用起来是没问题的，我将排查这个问题或者重新克隆项目。下一步，我将研究怎么把数字人搬到手机上，然后学习UE的操作和蓝图编程，更换数字人模型。

推荐系统方面，我觉得PPT有些凝练，我打算试试从[慕课](https://www.icourse163.org/course/PKU-1464038187)入手。

设计模式方面，我看完了书的第一章，认识了策略模式，观察者模式。这本书写的有趣易懂，正是我想学的内容。

学校方面，我完成了智能计算的三次实验，有关A*算法、博弈树、模糊推理；建模技术最后一次作业，有关进化算法。下周三下午有建模技术的考试，未来几天我将用来复习，下次组会想请一次假。

组会方面，我能听懂论文的任务，和一些思路的通俗表达。但是PPT上的英文和公式，网络的输入输出，训练方法、评价指标等细节不能一下子理解。目前我的收获有限，仅能丰富一下见识，了解大家在做什么。

总的来说，做的事情不太多，周三之前在看代码，逐行地看了很多细节。之后就是在做课程实验，精益求精地达到了想要的效果（附张图），上课的时间用来看设计模式。我的时间利用的还是有些随意和不够高效，感觉一天一周过的很快。也许我应该每天都小结一下，再汇总成周报会好一些。

## 2024.11.24

周一二三：复习考试。

周四：增加控制器接收文本不做处理原样输出，通过配置文件指定回复方式。首次安卓打包，耗时较长（首次打包的缘故），日志里有一条报错（路径中明明存在该dll文件，但日志却说找不到）和若干警告，装到手机上无法正常使用。

周五：成功打包自带的游戏示例工程（附安装包），证明打包环境无问题，重新尝试打包依旧失败，不过速度快多了。设计模式书看完第二章，学习了观察者模式的更多内容。

周六：测试fay-android，能够正常使用，充当远程麦克风和扬声器，回话比电脑慢一些。测试duix手机端数字人模型（附截图），循环动画中头部晃动动作偏快幅度偏大，口型效果还不错。

周日：搞懂并五子棋搜索减枝，编写代码，完成三次的实验报告。之后准备看一下第三章装饰器模式。

## 2024.12.01

老师，这周没有什么进展，我继续在做UE打包和duix，因为UE距离目标仅有一步之遥，我重装了系统，重装了打包环境，尝试了旧一版的UE工程，离谱的是我照着Fay官方的windows打包演示视频，也还是报了unkown error。我还看了一点安卓的教程，但构建和运行项目都没能成功，同时担忧duix无法满足形象定制的要求。

按照时间顺序梳理和记录一下我从开始做数字人的过程和遇到的困难：

- Fay部署运行成功
- LinLy-Talk由于依赖和模型下载问题本地部署失败，在云服务器上通过镜像体验了一番，生成时间较长，放弃。
- xuniren（照片驱动数字人项目）由于依赖问题部署失败，放弃。
- UE编译着色器时，耗时长，电脑发烫、风扇狂转，怀疑电脑带不动，暂时放弃。
- 使用虚拟声卡+Live2D模型实现数字人。
- 成功接入B站弹幕。尝试B站直播，音频设备输入输出、软件、直播间之间的音频流没调试好，暂时放弃。
- UE工程对接成功。
- 理解Fay代码。
- 在NLP函数里加入鸿蒙知识库调用和不做处理逻辑，测试成功。
- UE工程打包安卓失败（无法加载dll文件）。
- Fay安卓连接器对接成功。
- duix数字人对接成功。
- duix项目构建运行失败，可能由于IDE、SDK、构建工具的版本问题，会报不同的错。

聊一下我的想法。您问我数字人有意思吗？我的想法是无感，创造技术和应用技术也许是有意思的，但我目前只能算做技术的搬运工。我初高中喜欢玩游戏，学了计算机，我认识到游戏的本质是代码，是数据的集合，是虚拟的，我就对游戏提不起兴趣了。当我知道AI的本质是模型拟合数据，就不觉得AI很神奇了。学习和劳动本身是快乐的，可当学习和应试，劳动和上班捆绑后，就被异化了。我想做和我应该做是完全不同的感觉，大部分时候却是不得不做。数字人也是类似吧，不讨厌也谈不上喜欢。

这是我的毕业设计，也是您交给我的第一个任务，我想要出色的完成。然而大部分时间我都用在了搭环境，测试效果，打包项目这类测试运维的工作，常常是折腾半天没有成效，让我感到很崩溃。只有看懂Fay的代码有些收获，却只在一个函数里改了几行代码。之前还在写着课设级别的项目，现在却要实现一个商业级别的数字人，虽然是基于开源项目，这个跨度还是感觉压力山大。

我觉得我只做数字人是存在问题的，因为进展是不可预知的，有时会在短时间内产生很多成果，有时遇到问题就只能对着日志、博客尝试解决，或者重新走一遍流程，有时对口的issue极少就会僵持在那里死磕，我很厌烦这种低效的状态。我应该从CPU的并发学习经验，全面发展，转换思路，从其他方面寻求正反馈，帮助我度过低效的瓶颈时期。我在github上找到一个对数字人技术总结的[仓库](https://github.com/YUANZHUO-BNU/metahuman_overview)，可以作为我接下来的研究对象。我个人倾向于UE这个方向，模型的透明度和自由度较高，也能做UI。如果实在过不去打包的坎，我就去看看图片和视频驱动的数字人。

## 2024.12.08

数字人方面，我在win打包成功并验证可用性后，再次尝试安卓打包。虽然打包没有报错，但安装到手机后仍然存在闪退问题。我猜测和网络问题有关，理由一：在我IP修改为电脑后，APP从发消息后闪退变为一启动就闪退。理由二：从手机浏览器访问，好久才能加载出网页，无法使用，同时终端中有304的状态码。我准备下一步开始学习和理解UE工程中的蓝图（C++可视化编程）控制逻辑，观测Fay和UE之间发送的JSON内容，尝试找出和解决问题。

设计模式方面，前两周共看了5章，包括装饰者、工厂、单件、命令、适配器与外观模式，阅读进度44%。

组会方面，我不是没问题，而是问题多到靠提问去理解不现实了。所以我还是得尽快了解推荐系统的框架、流程、指标、方法，才能跟你们有共同语言。

论文方面，您发论文给我挂名，让我受宠若惊。虽然不太理解分量有多重，但是十分感谢。我用了两天时间入门Latex，未来应该能用得到，很方便的工具。

我未来打算选学[CS自学指南](https://csdiy.wiki/)中的一些国外课程，我这周看了[MIT-Missing-Semester](https://missing-semester-cn.github.io/)的前4节课，了解了一些shell和vim的东西。

然后汇报一下本学期的剩余安排：

- 14周整周：硬件课程设计

- 16周：智能计算考试

- 18周：软件工程考试及大作业

- 软件课程设计（OS实验），重大将清华的ucore课程实验移植到LoongArch32，要求应该降低了，一般一个任务只修改一个函数，不过我还是云里雾里的。赵老师也没说清楚要求和时间，只给了一个[实验网站](https://www.educoder.net/paths/gsnk6w9t)和指导书。

## 2024.12.15

周一到周四的早八晚六，提前一天完成了仿真机械臂实验。

其余时间里，设计模式看了两章：模板方法模式、迭代器与组合模式。

MIT-Missing-Semester看了第5-7讲，讲了Git和一些命令行工具。

UE这周没看，下周推一推进度。

如果一定要给自己一个目标，我想成为计算机高手，让计算机成为兴趣。拿到高薪，改变命运，改善家人的生活。（身边搞算法竞赛的同学拿到华为50w的offer。很震撼，同样的四年，差距竟然如此大），具体到想做的事，有这么几个特征：

第一是自洽，完成应该做的事，做观念上有益的事，与能力匹配的事，性价比高的事，提高效率的事。

第二是正反馈，能直观地感受到自己的进步，这种事也容易坚持。

第三是对未来影响的时间维度越长越好。

这是我理性上的想法，但身体很诚实，往往受情绪脑的支配，在行动上大大折扣。希望在将来不断改善。

## 2024.12.22

杜老师您好，数字人方面，我通过官方文档快速入门蓝图基本操作，然后直接对照项目中的节点，一边查一边理解，已经有了一定进展。希望能在理解程序逻辑后能够解决安卓问题和模型替换。模型定制是一个难点，初步思路是通过多角度拍摄，通过点云生成3d头部，然后绑定关键点。再加上声音克隆，是我之后的路线。最后附上一段演示视频，升级了流式处理（拆成句子，逐句合成音频）对于大段文本的延迟大幅降低，不过音频有些BUG。

其他方面，我阅读完了设计模式，观察者模式在UE事件分发器和Qt信号槽的体现，装饰者模式对于IO流的包装，模板方法模式中的钩子函数，组合模式对于GUI窗口和组件的管理，都加深了我对程序的理解。MIT的课也看完了，其中Git的实用性最高，我已经用到了Fay的代码管理。其他很多工具如vim、make等还需要练习来消化。

下周三下午有智能计算技术的考试，需要再速成一波。如果组会在下午就请个假，等26号我就来实验室打卡了。我的毕业设计需要外文翻译，您有空给我发一下原文。（[关于启动2025届本科毕业设计（论文）工作的通知](https://jwc.njust.edu.cn/32/47/c1217a340551/page.htm)）

## 2024.12.29

周三考试之后，周四周五教室友做硬件实验和往实验室搬东西，看了一晚蓝图。

周六：上午完成硬件实验报告，下午练习LaTex写软件工程大作业。

周日：上午练习使用vim，晚上做OS课设。

我目前的安排是早上从9点到12点在实验室。午睡久一点，然后跑5-10km。下午三四点去，可以坐到晚上10点。实验室干活的效率还不错，因为不好意思做别的事情，很快就进入状态了。我一般会先做不得不做的事（课程布置的任务），然后做一些感兴趣的事（探索有用的工具和学习新知识），最后做应该做的事（理解UE数字人的实现）。我现在对数字人的心态还不错，慢慢来，总有一天能做出一个完成度高的东西。就是感觉这东西和科研的关系不大，纯工程项目，baseline是啥，怎么评价。

## 2025.01.05

这周做的事情如下：

- OS课设：难以理解，还好有参考答案保命。

- 软工报告：复用旧报告，我负责审稿和修稿，体验到了小组合作的效率。

- 杜老师同款资料库：https://zxblog.netlify.app/

- MIT18.06线性代数：看了6/35，再次被惊艳，不愧是线代天花板，把概念存在的意义和联系，都讲清楚了。

- 普林斯顿的算法课：开了个头，乘着室友准备机试，补一下短板。

国外的课程总是有种删繁就简，直指核心的魅力，同时强调应用。而国内的课一般会按照定义、定理、证明、例题的顺序来讲，给人一种抽象和无用的感觉。可惜大四才领悟到。

## 2025.01.12

周四考完试，又坐了一整天火车，昨天到家。

线代看了3节课，李宏毅看了6节课。

沈飞哥让我先看看Ip-adapter、controlnet、Stable diffusion，明晚讲讲实验的事情。

这周没干啥，但任务一件接一件，感觉节奏好快。数字人、您推荐的方向、沈飞哥的安排、后天的课程考核、开题、我想学的课，不知道怎么合理安排。work-life balance好难，假期在家，还未进入专注学习的状态，也做不到没有负罪感的放松休息。

## 2025.01.19

周一，在开会前看了扩散模型的原理，即在训练数据上添加噪声（同分布采样），训练模型预测噪声。即可从随机噪声，在提示词的指导下经过多轮降噪得到生成图像。

周日，看了注意力机制的原理，输入是一串向量，每个向量都有自己的query，key，value，使用自己的query和全部key计算注attention score（代表别的向量和自己的相关程度），然后所有value对score加权求和，得到自己的输出向量。这样就可以针对性地利用到所有向量中的信息。在这个课题里是把图像作为q，除prompt的额外文本作为k,v。

两个都是看的李宏毅的课，精彩易懂，收获很多。ip-adapter，作用是加入图像提示词作为生成的参考，原理还没看，之后会去看一下。

中间几天，零零散散把代码浏览了一遍，代码里用了accelerate、diffusers、transformers库中的一些类，还不太清楚这些类的作用，没有和原理对应起来。预训练权重（这个东东还挺大，不好下载）、训练得到的权重、训练的数据集，不太清楚怎么获取、放置、使用。

这周表现不是很好，在家的生活不太规律。父母工作原因，经常不能按时吃饭，我就得自己做饭。有时帮忙干些活，最近就在给家里刮腻子。我自己假期里也比较懒散，作息也不太好，所以在上面投入的时间比较少，我再加把劲儿。

## 2025.02.16

我看完了IP-Adapter的论文，我发现我的英文阅读能力还可以，看一篇论文需要2-3天。

论文要做的任务是加入图像提示，旧方法包括微调、从零训练、把文本特征和图像特征concat后做attention。

论文的创新叫做解耦注意力：把CLIP编码的图像嵌入投影到长度为4的特征序列，维数和文本特征相同。对于扩散模型中的每个text注意层，添加一个额外的image注意层，两注意层输出求和，嵌入到预测噪声的U-Net。在训练阶段，只训练新注意层，原始模型保持冻结状态。预测阶段可以调节文本和图像提示词的比例。

全文都在翻来覆去的讲摘要的内容，用很多篇幅讲别人的问题，讲自己的优势：轻量、可复用、兼容、可以同时使用文本和图像提示词。公式也没几个，公式（6）是2范数期望的loss用来把预测的噪声约束到高斯分布，公式（7）随机丢弃条件的公式，用来联合训练有条件和无条件扩散模型。感觉方法很简单，效果好的解释是新方法能获得细粒度的图像特征，而直接concat不能。实验放了很多对比效果图，效果好就是真的好。

论文没有介绍网络的结构，我还需要看一下stable diffsion和unet的论文。在论文里我还发现一些重要的知识如CLIP（将文本和图像编码到到同一潜空间，同一对文图或概念相近的东西相似度更高，从而实现多模态）。

## 2025.02.22

这周看完了stable diffusion的论文正文，附录有点多，讲的是之前的扩散模型是在像素空间做比较吃资源，这个工作就把图像编码压缩到潜空间。论文还说扩散模型具有给定条件y，建模图像中间表示z分布的能力。去噪网络是由若干attention层组成，使用编码器τ把条件y投影到中间表示作为key和value，上一层的输出作为query，这样就把条件加入到网络中了。我们想要实现的对数量的控制，原理应该就是通过文本提示词，将数量和类别信息作为条件融入扩散模型，模块中的层我还是解释不了，不过条件加入attention前的处理都可以归属于编码器τ，属于个人设计。

从余健哥那里得知，文档里展示的效果图是第一版的代码跑出来的（这版是直接修改原prompt，没有增加新提示词extra text）。沈飞哥给我的代码仓库是在尝试新的设计，可能是想把之前获得的效果迁移到一个新提示词extra text，原提示词prompt还用做风格的控制。所以我想用新的设计跑出之前的效果是有些徒劳的（很郁闷为什么已经跑出来的效果，我却一直复现不出来），在我修改前后的代码上，都存在模块没控制效果和破坏图像，所以我拿到的代码也是一个有问题的半成品。

我总结下来问题还是没有交流到位，我得到的信息较少，导致对沈飞哥的期望比较模糊。模型的详细结构只看论文还看不出来，感觉看过的论文主要以方法、实验和效果展示为主，其他章节的重复性高且没什么内容。

## 2025.03.01

看了4篇论文，InstantStyle看的翻译，其他三篇LoRA只看了方法部分原文，[总结笔记（精华部分）](https://g01rm0wl834.feishu.cn/docx/FhD9d3xDnopyoRxmnGic6KTin3e)

沈飞师兄新安排的任务：每种对象数量（1-15）各找几张图片，测试各种模型，整理结果，总结问题缺点1-2句话（类似论文的动机）。

## 2025.03.09

做事多少能收获点东西（收获了什么心里有数），但当能力不匹配时（我只是态度端正，当了四年乖学生，我知道自己几斤几两），只能是消磨时间和热情，还不一定能做出什么东西，我宁愿低开高走。

您一直强调要输出，要解决问题。但输出是需要大量输入的，问题分而治之也是慢慢养成的，问题是什么本身就是个问题。有的问题在学习过程自然就解决了，或者发现根本不是问题。学生时代是最后一段有大块时间用来学习的阶段了。

参与别人的课题，论文发不出来，有我的责任；论文发出来，没有贡献相当于白嫖。不需要别人压力，我自己就会压力自己。所以以后我参与合作、接受安排，都要考虑好自己能不能胜任。

读个研为什么要压抑自己呢，我对毕业没有执念，毕业要求达不到没关系（说明我不是科研的料），但我不能像本科一样优绩主义、虚度时间。无效的努力还不如不努力，我只对自己负责，有大量优质资源等着我去学习，去提升。

对于毕业设计，我是这样打算的。我想把Fay消化成自己的项目，能复用的复用，简化保留核心逻辑，砍掉前端网页、数据库等非核心功能，只保留与UE通信的接口，目前已经完成了一部分。克隆自己的数字人模型有点麻烦，我看过教程，需要在光线良好的环境下全角度拍摄一百多张照片。UE有空也想尝试自己实现，说不定之后能找到手机闪退的原因。服务器后端负责（接受请求->语音识别->调用LLM->合成语音->生成唇形->返回结果），UE前端负责（录音、唇形动画播放、对话框显示），模型都尽量在本地调用。5月中旬要提交论文定稿，5月26日发布毕设成绩，我能做多少算多少。

之后不想写周报了，感觉周报有些形式了，每次一写就是半天。我已经按照966的建议打卡，不需要周报的督促了。如果需要交流，短的微信，长的邮件。如果您发现我松懈了尽管批评，我不玻璃心，挨打就立正。